<!DOCTYPE html>
<html>
<head>
	<title>Box Popper</title>
</head>
<style type="text/css">
		canvas {
			border: 1px solid black;
		}
	</style>
<body>
	<center><canvas id="canvas" width="600" height="400"></canvas></center>
	<script type="text/javascript">
		var canvas = document.getElementById("canvas");
		var context = canvas.getContext("2d");

		var boxes = [];

		var maxDuration = 50
		var maxSize = 40
		var maxNumber = 20

		var colors = [
			"red",
			"blue",
			"green",
			"#8B008B",
			"orange",
			"yellow",
			"pink",
			"purple"
		]

		function randomNum(n){
			return Math.floor(Math.random()*n)+1;
		}

		function createBox() {
			return {
				x: randomNum(canvas.width - maxSize),
				y: randomNum(canvas.height - maxSize),
				size: randomNum(maxSize),
				color: colors[randomNum(colors.length)],
				duration:randomNum(maxDuration)+5
			}
		}

		function createMultipleBoxes(n){
			for (i = 0;i < n; i++){
				boxes.push(createBox());
			}
		}
		
		function reduceDuration(){
			for(i = 0;i < boxes.length;i++){
				boxes[i].duration--

				if(boxes[i].duration <= 0){
					boxes[i] = createBox();
				}
			}
		}

		function drawBox(){
			for (i = 0;i < boxes.length; i++){
				context.fillStyle = boxes[i].color
				context.fillRect(
					boxes[i].x,
					boxes[i].y,
					boxes[i].size,
					boxes[i].size)
			}	
		}

		function run(){
			context.clearRect(0,0,canvas.width,canvas.height);
			drawBox();
			reduceDuration();
			requestAnimationFrame(run);
		}

		createMultipleBoxes(maxNumber);
		run();
	</script>
</body>
</html>	